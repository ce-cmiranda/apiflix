#!/usr/bin/env python
# coding: utf-8

# In[1]:


import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
get_ipython().run_line_magic('matplotlib', 'inline')
from datetime import datetime
from IPython.display import display, Math


# ## Tratamento da base movies

# In[31]:

###Acredito que faltou importar como UTF-8

movies = pd.read_csv('IMDb movies.csv', index_col = 'imdb_title_id', parse_dates=['date_published'], dtype = {'year':'str'})
df = {"eur":{"code":"EUR","alphaCode":"EUR","numericCode":"978","name":"Euro","rate":0.89920557874279,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":1.1120927445736},"gbp":{"code":"GBP","alphaCode":"GBP","numericCode":"826","name":"U.K. Pound Sterling","rate":0.81078319016952,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":1.233375348829},"jpy":{"code":"JPY","alphaCode":"JPY","numericCode":"392","name":"Japanese Yen","rate":107.24352724665,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.0093245720807009},"chf":{"code":"CHF","alphaCode":"CHF","numericCode":"756","name":"Swiss Franc","rate":0.96245048428736,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":1.0390144909537},"aud":{"code":"AUD","alphaCode":"AUD","numericCode":"036","name":"Australian Dollar","rate":1.5013128492952,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.66608368833282},"cad":{"code":"CAD","alphaCode":"CAD","numericCode":"124","name":"Canadian Dollar","rate":1.3758264185104,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.72683587591136},"krw":{"code":"KRW","alphaCode":"KRW","numericCode":"410","name":"South Korean Won","rate":1236.9231165003,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.00080845768557496},"bgn":{"code":"BGN","alphaCode":"BGN","numericCode":"975","name":"Bulgarian Lev","rate":1.7568799053872,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.56919086895675},"pgk":{"code":"PGK","alphaCode":"PGK","numericCode":"598","name":"Papua New Guinean kina","rate":3.4450325023277,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.290273023353},"irr":{"code":"IRR","alphaCode":"IRR","numericCode":"364","name":"Iranian rial","rate":41972.40520711,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":2.3825177400856e-5},"nio":{"code":"NIO","alphaCode":"NIO","numericCode":"558","name":"Nicaraguan C\u00f3rdoba","rate":33.804833333333,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.029581568710589},"nad":{"code":"NAD","alphaCode":"NAD","numericCode":"516","name":"Namibian dollar","rate":17.292008639309,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.057830181609252},"sdg":{"code":"SDG","alphaCode":"SDG","numericCode":"938","name":"Sudanese pound","rate":54.538147138965,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.018335789762934},"mru":{"code":"MRU","alphaCode":"MRU","numericCode":"929","name":"Mauritanian ouguiya","rate":38.197519083969,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.026179710724189},"tzs":{"code":"TZS","alphaCode":"TZS","numericCode":"834","name":"Tanzanian shilling","rate":2288.7935963408,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.0004369113936699},"mur":{"code":"MUR","alphaCode":"MUR","numericCode":"480","name":"Mauritian Rupee","rate":40.130663059163,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.024918601482506},"isk":{"code":"ISK","alphaCode":"ISK","numericCode":"352","name":"Icelandic Krona","rate":135.4402836376,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.0073833277156722},"pkr":{"code":"PKR","alphaCode":"PKR","numericCode":"586","name":"Pakistani Rupee","rate":160.93226690957,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.0062137942825469},"lyd":{"code":"LYD","alphaCode":"LYD","numericCode":"434","name":"Libyan Dinar","rate":1.4145722514046,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.70692748214667},"pab":{"code":"PAB","alphaCode":"PAB","numericCode":"590","name":"Panamanian Balboa","rate":0.98832214102312,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":1.0118158427219},"xcd":{"code":"XCD","alphaCode":"XCD","numericCode":"951","name":"East Caribbean Dollar","rate":2.6790924909651,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.37326072293972},"ang":{"code":"ANG","alphaCode":"ANG","numericCode":"532","name":"Neth. Antillean Guilder","rate":1.7749745045005,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.56338837401015},"dop":{"code":"DOP","alphaCode":"DOP","numericCode":"214","name":"Dominican Peso","rate":55.367911479946,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.018061002722889},"mnt":{"code":"MNT","alphaCode":"MNT","numericCode":"496","name":"Mongolian togrog","rate":2779.9305555555,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.00035972121605756},"dzd":{"code":"DZD","alphaCode":"DZD","numericCode":"012","name":"Algerian Dinar","rate":128.35383333808,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.0077909632614246},"pln":{"code":"PLN","alphaCode":"PLN","numericCode":"985","name":"Polish Zloty","rate":3.9972111568209,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.25017442430921},"brl":{"code":"BRL","alphaCode":"BRL","numericCode":"986","name":"Brazilian Real","rate":5.3739298160426,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.18608356160788},"azn":{"code":"AZN","alphaCode":"AZN","numericCode":"944","name":"Azerbaijan Manat","rate":1.7015896285585,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.58768576348643},"ghs":{"code":"GHS","alphaCode":"GHS","numericCode":"936","name":"Ghanaian Cedi","rate":5.7696790544469,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.17331986589952},"gmd":{"code":"GMD","alphaCode":"GMD","numericCode":"270","name":"Gambian dalasi","rate":51.190537084398,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.019534860483126},"awg":{"code":"AWG","alphaCode":"AWG","numericCode":"533","name":"Aruban florin","rate":1.7896548640915,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.55876695560942},"zmw":{"code":"ZMW","alphaCode":"ZMW","numericCode":"967","name":"Zambian kwacha","rate":17.627036547776,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.056731033449078},"yer":{"code":"YER","alphaCode":"YER","numericCode":"886","name":"Yemeni rial","rate":247.01345180797,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.0040483625190478},"bnd":{"code":"BND","alphaCode":"BND","numericCode":"096","name":"Brunei Dollar","rate":1.413216563958,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.70760563207616},"sgd":{"code":"SGD","alphaCode":"SGD","numericCode":"702","name":"Singapore Dollar","rate":1.4125141802204,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.70795749451801},"ils":{"code":"ILS","alphaCode":"ILS","numericCode":"376","name":"Israeli New Sheqel","rate":3.5083190257318,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.28503679188395},"kgs":{"code":"KGS","alphaCode":"KGS","numericCode":"417","name":"Kyrgyzstan Som","rate":73.728087422488,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.013563351972901},"jod":{"code":"JOD","alphaCode":"JOD","numericCode":"400","name":"Jordanian Dinar","rate":0.70507673774122,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":1.4182853389882},"stn":{"code":"STN","alphaCode":"STN","numericCode":"930","name":"S\u00e3o Tom\u00e9 and Pr\u00edncipe Dobra","rate":22.426330532213,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.044590442407134},"djf":{"code":"DJF","alphaCode":"DJF","numericCode":"262","name":"Djiboutian franc","rate":176.04556049079,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.0056803477305088},"all":{"code":"ALL","alphaCode":"ALL","numericCode":"008","name":"Albanian lek","rate":111.94038198037,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.0089333266718293},"khr":{"code":"KHR","alphaCode":"KHR","numericCode":"116","name":"Cambodian riel","rate":4072.3296032553,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.00024555969123929},"cop":{"code":"COP","alphaCode":"COP","numericCode":"170","name":"Colombian Peso","rate":3720.9961630936,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.00026874523814843},"xaf":{"code":"XAF","alphaCode":"XAF","numericCode":"950","name":"Central African CFA Franc","rate":600.69232636454,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.0016647457543733},"tmt":{"code":"TMT","alphaCode":"TMT","numericCode":"934","name":"New Turkmenistan Manat","rate":3.4961966197655,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.28602510349291},"uyu":{"code":"UYU","alphaCode":"UYU","numericCode":"858","name":"Uruguayan Peso","rate":42.983577418244,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.023264699219185},"fjd":{"code":"FJD","alphaCode":"FJD","numericCode":"242","name":"Fiji Dollar","rate":2.1939603200701,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.45579675751294},"cdf":{"code":"CDF","alphaCode":"CDF","numericCode":"976","name":"Congolese franc","rate":1809.7197106691,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.0005525717568884},"szl":{"code":"SZL","alphaCode":"SZL","numericCode":"748","name":"Swazi lilangeni","rate":17.292008639309,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.057830181609252},"npr":{"code":"NPR","alphaCode":"NPR","numericCode":"524","name":"Nepalese Rupee","rate":119.7600670137,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.0083500287277361},"inr":{"code":"INR","alphaCode":"INR","numericCode":"356","name":"Indian Rupee","rate":75.591518705758,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.013228997341521},"bbd":{"code":"BBD","alphaCode":"BBD","numericCode":"052","name":"Barbadian Dollar","rate":1.9996961988583,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.50007596182407},"vnd":{"code":"VND","alphaCode":"VND","numericCode":"704","name":"Vietnamese Dong","rate":23271.872782895,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":4.2970327714021e-5},"egp":{"code":"EGP","alphaCode":"EGP","numericCode":"818","name":"Egyptian Pound","rate":15.831400339096,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.063165606237022},"crc":{"code":"CRC","alphaCode":"CRC","numericCode":"188","name":"Costa Rican Col\u00f3n","rate":568.37866488465,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.001759390458829},"lrd":{"code":"LRD","alphaCode":"LRD","numericCode":"430","name":"Liberian dollar","rate":198.17326732673,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.0050460892808074},"ssp":{"code":"SSP","alphaCode":"SSP","numericCode":"728","name":"South Sudanese pound","rate":159.96403596404,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.0062514051610001},"ern":{"code":"ERN","alphaCode":"ERN","numericCode":"232","name":"Eritrean nakfa","rate":14.903574087863,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.067097999050736},"sos":{"code":"SOS","alphaCode":"SOS","numericCode":"706","name":"Somali shilling","rate":572.03486710487,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.0017481451874798},"myr":{"code":"MYR","alphaCode":"MYR","numericCode":"458","name":"Malaysian Ringgit","rate":4.3476060354013,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.23001164131646},"ron":{"code":"RON","alphaCode":"RON","numericCode":"946","name":"Romanian New Leu","rate":4.3546671259605,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.2296386775555},"pen":{"code":"PEN","alphaCode":"PEN","numericCode":"604","name":"Peruvian Nuevo Sol","rate":3.4280676278717,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.29170953101087},"lbp":{"code":"LBP","alphaCode":"LBP","numericCode":"422","name":"Lebanese Pound","rate":1506.6695382625,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.00066371554916628},"mga":{"code":"MGA","alphaCode":"MGA","numericCode":"969","name":"Malagasy ariary","rate":3783.6483931947,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.00026429517124229},"ttd":{"code":"TTD","alphaCode":"TTD","numericCode":"780","name":"Trinidad Tobago Dollar","rate":6.6863203607816,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.14955909170393},"htg":{"code":"HTG","alphaCode":"HTG","numericCode":"332","name":"Haitian gourde","rate":105.3447368421,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.0094926432015193},"mop":{"code":"MOP","alphaCode":"MOP","numericCode":"446","name":"Macanese pataca","rate":7.900335504243,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.12657690290025},"wst":{"code":"WST","alphaCode":"WST","numericCode":"882","name":"Samoan tala","rate":2.6746174918153,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.37388523893983},"nok":{"code":"NOK","alphaCode":"NOK","numericCode":"578","name":"Norwegian Krone","rate":9.705521107369,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.10303413788269},"try":{"code":"TRY","alphaCode":"TRY","numericCode":"949","name":"Turkish Lira","rate":6.831832161179,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.14637361931729},"bdt":{"code":"BDT","alphaCode":"BDT","numericCode":"050","name":"Bangladeshi taka","rate":84.866075170858,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.011783271442526},"tnd":{"code":"TND","alphaCode":"TND","numericCode":"788","name":"Tunisian Dinar","rate":2.8666225191318,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.34884258158373},"svc":{"code":"SVC","alphaCode":"SVC","numericCode":"222","name":"Salvadoran colon","rate":8.6572231833911,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.11551047937848},"cve":{"code":"CVE","alphaCode":"CVE","numericCode":"132","name":"Cape Verde escudo","rate":101.86005089058,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.0098173915215713},"mwk":{"code":"MWK","alphaCode":"MWK","numericCode":"454","name":"Malawian kwacha","rate":728.36608442505,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.0013729359746196},"gtq":{"code":"GTQ","alphaCode":"GTQ","numericCode":"320","name":"Guatemalan Quetzal","rate":7.5945740846137,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.13167295346107},"bam":{"code":"BAM","alphaCode":"BAM","numericCode":"977","name":"Bosnia and Herzegovina convertible mark","rate":1.7676852424269,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.56571157353052},"bwp":{"code":"BWP","alphaCode":"BWP","numericCode":"072","name":"Botswana Pula","rate":11.837489978316,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.084477368245448},"rub":{"code":"RUB","alphaCode":"RUB","numericCode":"643","name":"Russian Rouble","rate":70.547189297434,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.014174909163055},"idr":{"code":"IDR","alphaCode":"IDR","numericCode":"360","name":"Indonesian Rupiah","rate":14642.261292647,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":6.8295462020076e-5},"kzt":{"code":"KZT","alphaCode":"KZT","numericCode":"398","name":"Kazakhstani Tenge","rate":411.64738426287,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.0024292635839061},"gel":{"code":"GEL","alphaCode":"GEL","numericCode":"981","name":"Georgian lari","rate":3.1640338811032,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.31605224140373},"bhd":{"code":"BHD","alphaCode":"BHD","numericCode":"048","name":"Bahrain Dinar","rate":0.37340260806298,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":2.6780744922685},"xpf":{"code":"XPF","alphaCode":"XPF","numericCode":"953","name":"CFP Franc","rate":107.61889399683,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.0092920486622865},"mmk":{"code":"MMK","alphaCode":"MMK","numericCode":"104","name":"Myanma Kyat","rate":1379.427980703,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.00072493817291597},"omr":{"code":"OMR","alphaCode":"OMR","numericCode":"512","name":"Omani Rial","rate":0.3807146185816,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":2.6266393545003},"clp":{"code":"CLP","alphaCode":"CLP","numericCode":"152","name":"Chilean Peso","rate":811.91687933909,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.0012316531721991},"sek":{"code":"SEK","alphaCode":"SEK","numericCode":"752","name":"Swedish Krona","rate":9.4392310690794,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.10594083275234},"php":{"code":"PHP","alphaCode":"PHP","numericCode":"608","name":"Philippine Peso","rate":50.492668882192,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.019804855281728},"tjs":{"code":"TJS","alphaCode":"TJS","numericCode":"972","name":"Tajikistan Ruble","rate":10.25555911473,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.09750809183711},"pyg":{"code":"PYG","alphaCode":"PYG","numericCode":"600","name":"Paraguayan Guaran\u00ed","rate":6605.9563345144,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.00015137853618185},"bzd":{"code":"BZD","alphaCode":"BZD","numericCode":"084","name":"Belize dollar","rate":1.9932778967286,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.50168619320026},"kmf":{"code":"KMF","alphaCode":"KMF","numericCode":"174","name":"\tComoro franc","rate":438.07178813745,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.0022827308835652},"sll":{"code":"SLL","alphaCode":"SLL","numericCode":"694","name":"Sierra Leonean leone","rate":9622.8365384617,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.00010391946241663},"mvr":{"code":"MVR","alphaCode":"MVR","numericCode":"462","name":"Maldivian rufiyaa","rate":15.290679908327,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.065399315530464},"dkk":{"code":"DKK","alphaCode":"DKK","numericCode":"208","name":"Danish Krone","rate":6.6973048478612,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.14931379453622},"aed":{"code":"AED","alphaCode":"AED","numericCode":"784","name":"U.A.E Dirham","rate":3.6714644720598,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.27237087750953},"twd":{"code":"TWD","alphaCode":"TWD","numericCode":"901","name":"New Taiwan Dollar ","rate":29.992123265804,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.033342087558708},"uah":{"code":"UAH","alphaCode":"UAH","numericCode":"980","name":"Ukrainian Hryvnia","rate":26.87538744236,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.0372087659069},"bob":{"code":"BOB","alphaCode":"BOB","numericCode":"068","name":"Bolivian Boliviano","rate":6.8438666211836,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.14611623156196},"jmd":{"code":"JMD","alphaCode":"JMD","numericCode":"388","name":"Jamaican Dollar","rate":142.96785714286,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.006994579201119},"gip":{"code":"GIP","alphaCode":"GIP","numericCode":"292","name":"Gibraltar pound","rate":0.80336751690781,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":1.2447603107592},"mzn":{"code":"MZN","alphaCode":"MZN","numericCode":"943","name":"Mozambican metical","rate":68.079931972787,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.014688616322351},"kes":{"code":"KES","alphaCode":"KES","numericCode":"404","name":"Kenyan shilling","rate":105.95817893065,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.0094376857935101},"cny":{"code":"CNY","alphaCode":"CNY","numericCode":"156","name":"Chinese Yuan","rate":7.1397220569099,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.14006147466654},"kwd":{"code":"KWD","alphaCode":"KWD","numericCode":"414","name":"Kuwaiti Dinar","rate":0.30835333303743,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":3.2430328874655},"huf":{"code":"HUF","alphaCode":"HUF","numericCode":"348","name":"Hungarian Forint","rate":313.14099147907,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.0031934496830858},"ngn":{"code":"NGN","alphaCode":"NGN","numericCode":"566","name":"Nigerian Naira","rate":358.49828568884,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.0027894136176371},"iqd":{"code":"IQD","alphaCode":"IQD","numericCode":"368","name":"Iraqi dinar","rate":1189.1164864916,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.00084096050417266},"afn":{"code":"AFN","alphaCode":"AFN","numericCode":"971","name":"Afghan afghani","rate":75.727365593432,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.013205265918913},"srd":{"code":"SRD","alphaCode":"SRD","numericCode":"968","name":"Surinamese dollar","rate":7.3912481536188,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.13529514626165},"syp":{"code":"SYP","alphaCode":"SYP","numericCode":"760","name":"Syrian pound","rate":506.72151898733,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.0019734705603158},"top":{"code":"TOP","alphaCode":"TOP","numericCode":"776","name":"Tongan pa\u02bbanga","rate":2.2595958455633,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.44255701831082},"ugx":{"code":"UGX","alphaCode":"UGX","numericCode":"800","name":"Ugandan shilling","rate":3744.714686623,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.00026704304164273},"nzd":{"code":"NZD","alphaCode":"NZD","numericCode":"554","name":"New Zealand Dollar","rate":1.6089826712523,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.62151073337644},"hrk":{"code":"HRK","alphaCode":"HRK","numericCode":"191","name":"Croatian Kuna","rate":6.8147395321041,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.14674075146805},"byn":{"code":"BYN","alphaCode":"BYN","numericCode":"933","name":"Belarussian Ruble","rate":2.4081786912152,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.41525157732186},"mad":{"code":"MAD","alphaCode":"MAD","numericCode":"504","name":"Moroccan Dirham","rate":9.7757882017233,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.10229354189811},"etb":{"code":"ETB","alphaCode":"ETB","numericCode":"230","name":"Ethiopian birr","rate":33.526800670017,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.029826884164772},"sbd":{"code":"SBD","alphaCode":"SBD","numericCode":"090","name":"Solomon Islands dollar","rate":8.194677584442,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.12203042641953},"lak":{"code":"LAK","alphaCode":"LAK","numericCode":"418","name":"Lao kip","rate":8895.7777777777,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.00011241288001799},"cup":{"code":"CUP","alphaCode":"CUP","numericCode":"192","name":"Cuban peso","rate":0.98832214102312,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":1.0118158427219},"vuv":{"code":"VUV","alphaCode":"VUV","numericCode":"548","name":"Vanuatu vatu","rate":116.82425728127,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.0085598661037696},"sar":{"code":"SAR","alphaCode":"SAR","numericCode":"682","name":"Saudi Riyal","rate":3.7529819058628,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.26645478850773},"hkd":{"code":"HKD","alphaCode":"HKD","numericCode":"344","name":"Hong Kong Dollar","rate":7.7535547122669,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.12897310164303},"amd":{"code":"AMD","alphaCode":"AMD","numericCode":"051","name":"Armenia Dram","rate":483.47532269042,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.0020683578935017},"rsd":{"code":"RSD","alphaCode":"RSD","numericCode":"941","name":"Serbian Dinar","rate":105.58448362511,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.0094710886075895},"mkd":{"code":"MKD","alphaCode":"MKD","numericCode":"807","name":"Macedonian denar","rate":55.656586722279,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.017967325322875},"bif":{"code":"BIF","alphaCode":"BIF","numericCode":"108","name":"Burundian franc","rate":1872.3573433115,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.00053408608328546},"aoa":{"code":"AOA","alphaCode":"AOA","numericCode":"973","name":"Angolan kwanza","rate":580.15942028984,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.0017236641602758},"qar":{"code":"QAR","alphaCode":"QAR","numericCode":"634","name":"Qatari Rial","rate":3.6005576542544,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.27773475556443},"zar":{"code":"ZAR","alphaCode":"ZAR","numericCode":"710","name":"South African Rand","rate":17.488483628218,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.057180486385136},"mxn":{"code":"MXN","alphaCode":"MXN","numericCode":"484","name":"Mexican Peso","rate":22.111874514373,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.045224569239934},"mdl":{"code":"MDL","alphaCode":"MDL","numericCode":"498","name":"Moldova Lei","rate":17.591161661873,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.056846729012069},"ars":{"code":"ARS","alphaCode":"ARS","numericCode":"032","name":"Argentine Peso","rate":68.018685361854,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.01470184251107},"bsd":{"code":"BSD","alphaCode":"BSD","numericCode":"044","name":"Bahamian Dollar","rate":0.98832214102312,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":1.0118158427219},"gnf":{"code":"GNF","alphaCode":"GNF","numericCode":"324","name":"Guinean franc","rate":9463.5933806145,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.00010566810721691},"hnl":{"code":"HNL","alphaCode":"HNL","numericCode":"340","name":"Honduran Lempira","rate":24.543838136113,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.040743423846519},"lkr":{"code":"LKR","alphaCode":"LKR","numericCode":"144","name":"Sri Lanka Rupee","rate":184.17759374281,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.0054295421048688},"czk":{"code":"CZK","alphaCode":"CZK","numericCode":"203","name":"Czech Koruna","rate":24.176675396249,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.041362180018976},"thb":{"code":"THB","alphaCode":"THB","numericCode":"764","name":"Thai Baht","rate":31.823304668958,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.031423512121148},"xof":{"code":"XOF","alphaCode":"XOF","numericCode":"952","name":"West African CFA Franc","rate":599.97460491455,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.0016667372115565},"uzs":{"code":"UZS","alphaCode":"UZS","numericCode":"860","name":"Uzbekistan Sum","rate":10130.519054098,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":9.8711625204977e-5},"ves":{"code":"VES","alphaCode":"VES","numericCode":"928","name":"Venezuelan Bolivar","rate":209645.23809523,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":4.7699628624322e-6},"gyd":{"code":"GYD","alphaCode":"GYD","numericCode":"328","name":"Guyanese dollar","rate":207.28562551781,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.0048242611975719},"rwf":{"code":"RWF","alphaCode":"RWF","numericCode":"646","name":"Rwandan franc","rate":943.01531213191,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.0010604281681697},"lsl":{"code":"LSL","alphaCode":"LSL","numericCode":"426","name":"Lesotho loti","rate":17.292008639309,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.057830181609252},"scr":{"code":"SCR","alphaCode":"SCR","numericCode":"690","name":"Seychelles rupee","rate":17.397218600608,"date":"Sat, 30 May 2020 00:00:01 GMT","inverseRate":0.057480452649198}}
df = pd.DataFrame(df)
df= df.T
df['code'].loc['bsd'] = '$'
movies_df = movies[movies["budget"].notnull()][["budget"]].apply(lambda x: x.str.split(" "))
movies_df['moeda'] = movies_df[movies_df["budget"].notnull()][["budget"]].apply(lambda x: x[0][0], axis =1)
movies_df['valor'] = movies_df[movies_df["budget"].notnull()][["budget"]].apply(lambda x: x[0][1], axis =1)
movies_df.reset_index(inplace = True)
movies_df = pd.merge(movies_df,df, how = 'left', left_on = 'moeda', right_on = 'code')[['imdb_title_id','moeda','valor','code','rate','inverseRate']]
movies_df['valor'] = movies_df['valor'].astype('float')
movies_df['inverseRate'] = movies_df['inverseRate'].astype('float')
movies_df['budget_dollar'] = round(movies_df['valor'] * movies_df['inverseRate'] * 1,1)
movies_df = movies_df[['imdb_title_id','budget_dollar']]
movies = movies.reset_index()
movies = pd.merge(movies,movies_df, how='left', on = 'imdb_title_id')
movies = movies.sort_values(by = 'budget_dollar', ascending = False)
movies["worlwide_gross_income"] = movies[movies["worlwide_gross_income"].notnull()][["worlwide_gross_income"]].apply(lambda x: x.str.split(" "))
movies['income'] = movies[movies["worlwide_gross_income"].notnull()][["worlwide_gross_income"]].apply(lambda x: x[0][1], axis =1)
movies['income'].dropna(inplace = True)
movies['income'].astype('float')
movies.drop(axis = 1, labels = 'worlwide_gross_income', inplace = True)
movies.columns = ['imdb_title_id','Título','Título Original','Ano','Data de Publicação','Gênero','Duração','País','Idioma Original','Diretor',
                         'Escritor','Produtora','Atores','Descrição','Média de Nota', 'Quantidade de Votos','Orçamento',
                        'Faturamento Bruto EUA','metascore','Quantidade de Votos por Usuário',
                        'Quantidade de Votos por Críticos','Orçamento em Dólares Americanos','Faturamento Bruto Mundial']
movies['Faturamento Bruto Mundial'] = movies['Faturamento Bruto Mundial'].astype('float')
movies['percentual de lucro'] = round((movies['Faturamento Bruto Mundial'] - movies['Orçamento em Dólares Americanos'])/movies['Orçamento em Dólares Americanos'],1)
ratings = pd.read_csv('IMDb ratings.csv', index_col='imdb_title_id', parse_dates = True)
ratings.reset_index(inplace = True)
ratings['percentual nota 10'] = round((ratings['votes_10'] / ratings['total_votes'])*100,1)
ratings['percentual nota 1'] = round((ratings['votes_1'] / ratings['total_votes'])*100,1)
ratings = ratings[['imdb_title_id','percentual nota 10','percentual nota 1']]
movies = pd.merge(movies,ratings,how = 'left', on = 'imdb_title_id')
movies['percentual de lucro'] = movies['percentual de lucro'] *100


# In[30]:


movies.to_csv('movies_clean.csv')

